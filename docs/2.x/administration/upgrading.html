<!DOCTYPE html>
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha384-awusxf8AUojygHf2+joICySzB780jVvQaVCAt1clU3QsyAitLGul28Qxb2r1e5g+" crossorigin="anonymous">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jq-2.2.3/dt-1.10.12/datatables.min.css">
<link href="/css/accumulo.css" rel="stylesheet" type="text/css">

<title>Accumulo Documentation - Upgrading Accumulo</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/bs/jq-2.2.3/dt-1.10.12/datatables.min.js"></script>
<script>
  // show location of canonical site if not currently on the canonical site
  $(function() {
    var host = window.location.host;
    if (typeof host !== 'undefined' && host !== 'accumulo.apache.org') {
      $('#non-canonical').show();
    }
  });

  $(function() {
    // decorate section headers with anchors
    return $("h2, h3, h4, h5, h6").each(function(i, el) {
      var $el, icon, id;
      $el = $(el);
      id = $el.attr('id');
      icon = '<i class="fa fa-link"></i>';
      if (id) {
        return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
      }
    });
  });

  // fix sidebar width in documentation
  $(function() {
    var $affixElement = $('div[data-spy="affix"]');
    $affixElement.width($affixElement.parent().width());
  });
</script>

<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-50934829-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-50934829-1');
</script>

</head>
<body style="padding-top: 100px">

  <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-items">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/"><img id="nav-logo" alt="Apache Accumulo" class="img-responsive" src="/images/accumulo-logo.png" width="200"
        /></a>
    </div>
    <div class="collapse navbar-collapse" id="navbar-items">
      <ul class="nav navbar-nav">
        <li class="nav-link"><a href="/downloads">Download</a></li>
        <li class="nav-link"><a href="/tour">Tour</a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Releases<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/release/accumulo-2.0.0-alpha-1/">2.0.0-alpha-1 (Preview Release)</a></li>
            <li><a href="/release/accumulo-1.9.2/">1.9.2 (Latest)</a></li>
            <li><a href="/release/">Archive</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Documentation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/quickstart-1.x">Quickstart (1.x)</a></li>
            <li><a href="/1.9/accumulo_user_manual.html">User Manual (1.9)</a></li>
            <li><a href="/1.9/apidocs">Javadocs (1.9)</a></li>
            <li><a href="/1.9/examples">Examples (1.9)</a></li>
            <li><a href="/features">Features</a></li>
            <li><a href="/glossary">Glossary</a></li>
            <li><a href="/external-docs">External Docs</a></li>
            <li><a href="/docs-archive/">Archive</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/contact-us">Contact Us</a></li>
            <li><a href="/how-to-contribute">How To Contribute</a></li>
            <li><a href="/people">People</a></li>
            <li><a href="/related-projects">Related Projects</a></li>
          </ul>
        </li>
        <li class="nav-link"><a href="/search">Search</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#"><img alt="Apache Software Foundation" src="https://www.apache.org/foundation/press/kit/feather.svg" width="15"/><span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="https://www.apache.org">Apache Homepage <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/licenses/">License <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/foundation/sponsorship">Sponsorship <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/security">Security <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/foundation/thanks">Thanks <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct <i class="fa fa-external-link"></i></a></li>
            <li><a href="https://www.apache.org/events/current-event.html">Current Event <i class="fa fa-external-link"></i></a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <div class="container">
    <div class="row">
      <div class="col-md-12">

        <div id="non-canonical" style="display: none; background-color: #F0E68C; padding-left: 1em;">
          Visit the official site at: <a href="https://accumulo.apache.org">https://accumulo.apache.org</a>
        </div>
        <div id="content">
          
          <div class="row">
  <div class="col-md-3">
    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" data-spy="affix">
      <div class="panel panel-default">
      
      
      
        
          
        
          
        
          
            <div class="panel-heading" role="tab" id="headingOne">
              <h4 class="panel-title">
                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapsegetting-started" aria-expanded="false" aria-controls="collapsegetting-started">
                  Getting started
                </a>
              </h4>
            </div>
            <div id="collapsegetting-started" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
              <div class="panel-body">
                
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/getting-started/design">Accumulo Design</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/getting-started/quick-install">Quick Installation</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/getting-started/clients">Accumulo Clients</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/getting-started/shell">Accumulo Shell</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/getting-started/table_design">Table Design</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/getting-started/table_configuration">Table Configuration</a></div>
                
              </div>
            </div>
          
        
          
        
          
        
      
        
          
        
          
            <div class="panel-heading" role="tab" id="headingOne">
              <h4 class="panel-title">
                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapsedevelopment" aria-expanded="false" aria-controls="collapsedevelopment">
                  Development
                </a>
              </h4>
            </div>
            <div id="collapsedevelopment" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
              <div class="panel-body">
                
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/iterators">Iterators</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/mapreduce">MapReduce</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/proxy">Proxy</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/development_tools">Development Tools</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/sampling">Sampling</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/summaries">Summary Statistics</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/security">Security</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/high_speed_ingest">High-Speed Ingest</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/development/client-properties">Client Properties</a></div>
                
              </div>
            </div>
          
        
          
        
          
        
          
        
      
        
          
            <div class="panel-heading" role="tab" id="headingOne">
              <h4 class="panel-title">
                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseadministration" aria-expanded="true" aria-controls="collapseadministration">
                  Administration
                </a>
              </h4>
            </div>
            <div id="collapseadministration" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
              <div class="panel-body">
                
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/in-depth-install">In-depth Installation</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/configuration-management">Configuration Management</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/properties">Server Properties</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/monitoring-metrics">Monitoring & Metrics</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/tracing">Tracing</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/fate">FATE</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/multivolume">Multi-Volume Installations</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/ssl">SSL</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/kerberos">Kerberos</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/replication">Replication</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/caching">Caching</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/upgrading">Upgrading Accumulo</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/scan-executors">Scan Executors</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/administration/crypto">On Disk Encryption</a></div>
                
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
      
        
          
        
          
        
          
        
          
        
          
            <div class="panel-heading" role="tab" id="headingOne">
              <h4 class="panel-title">
                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapsetroubleshooting" aria-expanded="false" aria-controls="collapsetroubleshooting">
                  Troubleshooting
                </a>
              </h4>
            </div>
            <div id="collapsetroubleshooting" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
              <div class="panel-body">
                
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/troubleshooting/basic">Basic Troubleshooting</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/troubleshooting/advanced">Advanced Troubleshooting</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/troubleshooting/tools">Troubleshooting Tools</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/troubleshooting/system-metadata-tables">System Metadata Tables</a></div>
                
                <div class="row doc-sidebar-link"><a href="/docs/2.x/troubleshooting/performance">Performance</a></div>
                
              </div>
            </div>
          
        
      
      </div>
    </div>
  </div>
  <div class="col-md-9">
    
    <p>Accumulo 2.x Documentation &nbsp;&gt;&gt;&nbsp; Administration &nbsp;&gt;&gt;&nbsp; Upgrading Accumulo</p>
    

    <div class="alert alert-danger" style="margin-bottom: 0px;" role="alert">This documentation is for a future release of Accumulo! <a href="/1.9/accumulo_user_manual.html">View documentation for the latest release</a>.</div>

    <div class="row">
      <div class="col-md-10"><h1>Upgrading Accumulo</h1></div>
      <div class="col-md-2"><a class="pull-right" style="margin-top: 25px;" href="https://github.com/apache/accumulo-website/edit/master/_docs-2/administration/upgrading.md" role="button"><i class="glyphicon glyphicon-pencil"></i> <small>Edit this page</small></a></div>
    </div>

    <h2 id="upgrading-from-17-to-18">Upgrading from 1.7 to 1.8</h2>

<p>Upgrades from 1.7 to 1.8 are possible with little effort as no changes were made at the data layer and RPC changes were made in a backwards-compatible way. The recommended way is to stop Accumulo 1.7, perform the Accumulo upgrade to 1.8, and then start 1.8. Like previous versions, after 1.8 is started on a 1.7 instance, a one-time upgrade will happen by the Master which will prevent a downgrade back to 1.7. Upgrades are still one way. Upgrades from versions prior to 1.7 to 1.8 should follow the below path to 1.7 and then perform the upgrade to 1.8 – direct upgrades to 1.8 for versions other than 1.7 are untested.</p>

<p>Existing configuration files from 1.7 should be compared against the examples provided in 1.8. The 1.7 configuration files should all function with 1.8 code, but you will likely want to include changes found in the 1.8.0 release notes and these release notes for 1.8.1.</p>

<p>For upgrades from prior to 1.7, follow the upgrade instructions to 1.7 first.</p>

<h2 id="upgrading-from-17x-to-17y">Upgrading from 1.7.x to 1.7.y</h2>

<p>The recommended way to upgrade from a prior 1.7.x release is to stop Accumulo, upgrade to 1.7.y and then start 1.7.y.</p>

<p>When upgrading, there is a known issue if the upgrade fails due to outstanding <a href="https://accumulo.apache.org/1.7/accumulo_user_manual.html#_fault_tolerant_executor_fate">FATE</a> operations, see <a href="https://issues.apache.org/jira/browse/ACCUMULO-4496">ACCUMULO-4496</a> The work around if this situation is encountered:</p>

<ul>
  <li>Start tservers</li>
  <li>Start shell</li>
  <li>Run <code class="highlighter-rouge">fate print</code> to list all</li>
  <li>If completed, just delete with <code class="highlighter-rouge">fate delete</code></li>
  <li>Start masters once there are no more fate operations</li>
</ul>

<p>If any of the FATE operations are not complete, you should rollback the upgrade and troubleshoot completing them with your prior version. When performing an upgrade between major versions, the upgrade is one-way, therefore it is important that you do not have any outstanding FATE operations before starting the upgrade.</p>

<h2 id="upgrading-from-16-to-17">Upgrading from 1.6 to 1.7</h2>

<p>Upgrades from 1.6 to 1.7 are possible with little effort as no changes were made at the data layer and RPC changes were made in a backwards-compatible way. The recommended way is to stop Accumulo 1.6, perform the Accumulo upgrade to 1.7, and then start 1.7. Like previous versions, after 1.7.0 is started on a 1.6 instance, a one-time upgrade will happen by the Master which will prevent a downgrade back to 1.6. Upgrades are still one way. Upgrades from versions prior to 1.6 to 1.7 should follow the below path to 1.6 and then perform the upgrade to 1.7 – direct upgrades to 1.7 for versions other than 1.6 are untested.</p>

<p>After upgrading to 1.7.0, users will notice the addition of a replication table in the accumulo namespace. This table is created and put offline to avoid any additional maintenance if the data-center replication feature is not in use.</p>

<p>Existing configuration files from 1.6 should be compared against the examples provided in 1.7. The 1.6 configuration files should all function with 1.7 code, but you will likely want to include a new file (hadoop-metrics2-accumulo.properties) to enable the new metrics subsystem. Read the section on Hadoop Metrics2 in the Administration chapter of the Accumulo User Manual.</p>

<p>For each of the other new features, new configuration properties exist to support the feature. Refer to the added sections in the User Manual for the feature for information on how to properly configure and use the new functionality.</p>

<h2 id="upgrading-from-15-to-16">Upgrading from 1.5 to 1.6</h2>

<p>This happens automatically the first time Accumulo 1.6 is started.</p>

<p>If your instance previously upgraded from 1.4 to 1.5, you must verify that your
1.5 instance has no outstanding local write ahead logs. You can do this by ensuring
either:</p>

<ul>
  <li>All of your tables are online and the Monitor shows all tablets hosted</li>
  <li>The directory for write ahead logs (logger.dir.walog) from 1.4 has no files remaining
  on any tablet server / logger hosts</li>
</ul>

<p>To upgrade from 1.5 to 1.6 you must:</p>

<ul>
  <li>Verify that there are no outstanding FATE operations
    <ul>
      <li>Under 1.5 you can list what’s in FATE by running
<code class="highlighter-rouge">$ACCUMULO_HOME/bin/accumulo org.apache.accumulo.server.fate.Admin print</code></li>
      <li>Note that operations in any state will prevent an upgrade. It is safe
to delete operations with status SUCCESSFUL. For others, you should restart
your 1.5 cluster and allow them to finish.</li>
    </ul>
  </li>
  <li>Stop the 1.5 instance.</li>
  <li>Configure 1.6 to use the hdfs directory and zookeepers that 1.5 was using.</li>
  <li>Copy other 1.5 configuration options as needed.</li>
  <li>Start Accumulo 1.6.</li>
</ul>

<p>The upgrade process must make changes to Accumulo’s internal state in both ZooKeeper and
  the table metadata. This process may take some time if Tablet Servers have to go through
  recovery. During this time, the Monitor will claim that the Master is down and some
  services may send the Monitor log messages about failure to communicate with each other.
  These messages are safe to ignore. If you need detail on the upgrade’s progress you should
  view the local logs on the Tablet Servers and active Master.</p>

<h2 id="upgrading-from-14-to-16">Upgrading from 1.4 to 1.6</h2>

<p>To upgrade from 1.4 to 1.6 you must perform a manual initial step.</p>

<p>Prior to upgrading you must:</p>

<ul>
  <li>Verify that there are no outstanding FATE operations
    <ul>
      <li>Under 1.4 you can list what’s in FATE by running <code class="highlighter-rouge">$ACCUMULO_HOME/bin/accumulo org.apache.accumulo.server.fate.Admin print</code></li>
      <li>Note that operations in any state will prevent an upgrade. It is safe to delete operations with status SUCCESSFUL. For others, 
  you should restart your 1.4 cluster and allow them to finish.</li>
    </ul>
  </li>
  <li>Stop the 1.4 instance.</li>
  <li>Configure 1.6 to use the hdfs directory, walog directories, and zookeepers that 1.4 was using.</li>
  <li>Copy other 1.4 configuration options as needed.</li>
</ul>

<p>Prior to starting the 1.6 instance you will need to run the LocalWALRecovery tool on each node that previously ran an instance of the Logger role.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ACCUMULO_HOME/bin/accumulo org.apache.accumulo.tserver.log.LocalWALRecovery
</code></pre></div></div>

<p>The recovery tool will rewrite the 1.4 write ahead logs into a format that 1.6 can read. After this step has completed on all nodes, start the 1.6 cluster to continue the upgrade.</p>

<p>The upgrade process must make changes to Accumulo’s internal state in both ZooKeeper and the table metadata. This process may take some time if Tablet Servers have to go through recovery. During this time, the Monitor will claim that the Master is down and some services may send the Monitor log messages about failure to communicate with each other. While the upgrade is in progress, the Garbage Collector may complain about invalid paths. The Master may also complain about failure to create the trace table because it already exists. These messages are safe to ignore. If other error messages occur, you should seek out support before continuing to use Accumulo. If you need detail on the upgrade’s progress you should view the local logs on the Tablet Servers and active Master.</p>

<p>Note that the LocalWALRecovery tool does not delete the local files. Once you confirm that 1.6 is successfully running, you should delete these files on the local filesystem.</p>

<h2 id="upgrading-from-14-to-15">Upgrading from 1.4 to 1.5</h2>

<p>This happens automatically the first time Accumulo 1.5 is started.</p>

<ul>
  <li>Stop the 1.4 instance.</li>
  <li>Configure 1.5 to use the hdfs directory, walog directories, and zookeepers
that 1.4 was using.</li>
  <li>Copy other 1.4 configuration options as needed.</li>
  <li>Start Accumulo 1.5.</li>
</ul>



    <div class="row" style="margin-top: 20px;">
      <div class="col-md-10"><strong>Find documentation for all releases in the <a href="/docs-archive">archive</strong></div>
      <div class="col-md-2"><a class="pull-right" href="https://github.com/apache/accumulo-website/edit/master/_docs-2/administration/upgrading.md" role="button"><i class="glyphicon glyphicon-pencil"></i> <small>Edit this page</small></a></div>
    </div>  
  </div>
</div>

        </div>

        
<footer>

  <p><a href="https://www.apache.org/foundation/contributing"><img src="https://www.apache.org/images/SupportApache-small.png" alt="Support the ASF" id="asf-logo" height="100" /></a></p>

  <p>Copyright © 2011-2018 <a href="https://www.apache.org">The Apache Software Foundation</a>.
Licensed under the <a href="https://www.apache.org/licenses/">Apache License, Version 2.0</a>.</p>

  <p>Apache®, the names of Apache projects and their logos, and the multicolor feather
logo are registered trademarks or trademarks of The Apache Software Foundation
in the United States and/or other countries.</p>

</footer>


      </div>
    </div>
  </div>
</body>
</html>
